<!DOCTYPE html><html><head> <style> @font-face { font-family: "allseto"; src: url("https://raw.githubusercontent.com/yurenli0217/BoshiahkGV/master/Config/cjkFonts_allseto_v1.11.ttf"); } * { font-family: "allseto", serif; padding: 0; margin: 0; } #main { height: 100vh; width: 100vw; } #main .title { font-size: 10rem; text-align: center; padding-top: 10rem; } #main .file-select { text-align: center; font-size: 2rem; padding-top: 3rem; } #main .file-select label { border-radius: 5px; border-style: solid; border-width: 1px; cursor: pointer; padding: 5px 10px; color: white; background-color: rgb(59, 88, 88); transition: transform 2s; display: inline-block; } #main .file-select label.trans { transform: translateY(600px); } #main .status.hide { max-height: 0; overflow-y: hidden; opacity: 0; } #main .status.show { max-height: 100vh; overflow-y: initial; opacity: 1; } #main .status { padding-top: 2rem; text-align: center; font-size: 1.2rem; transition: all 2s; } #main .big5-check { text-align: center; font-size: 1rem; } #main .status #status-cover { padding: 2rem; font-size: 5rem; position: relative; display: inline-flex; height: 15rem; width: 15rem; justify-content: center; align-items: center; margin: 15px; } #main .status #status-cover::after { border-radius: 50%; position: absolute; content: ""; border-style: solid; height: 100%; width: 100%; border-width: 10px; } #main .status #status-cover.spin::after { border-top-color: rgb(118, 71, 230); animation-name: border-spin; animation-duration: 2s; animation-timing-function: linear; animation-iteration-count: infinite; } #main .status #status-text { padding-top: 2rem; font-size: 1.5rem; } #main .status #status-text-ps { padding-top: 1.5rem; font-size: 1.2rem; } @keyframes border-spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } </style></head><body> <div id="main"> <div class="title"> 作業批改程序 </div> <div class="status hide"> <div id="status-cover"></div> <div id="status-text"></div> <div id="status-text-ps"></div> </div> <div class="file-select"> <label for="zip-file" class=""> <span id="file-btn"> 選擇檔案 </span> </label> <input type="file" id="zip-file" style="display: none"> </div> </div> <div style="display:none"> <div> <div> 名字部分 </div> <div id="name"></div> <div> 正確答案 </div> <div id="name-answer"></div> <div> 驗證結果 </div> <div id="name-verify"></div> </div> <hr> <div> <div> 龍部分 </div> <div id="ryu"></div> <div> 正確答案 </div> <div id="ryu-answer"></div> <div> 驗證結果 </div> <div id="ryu-verify"></div> </div> </div> <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.26.2/docxtemplater.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.6.1/jszip.min.js"></script> <script src="./utf8.js"></script> <script src="https://cdn.jsdelivr.net/gh/jcubic/static@master/js/iconv.js"></script> <script> document.addEventListener("DOMContentLoaded",function(){function p(e,n){return e===n?"正確":"錯誤"}function v(e,n){var t=e.textContent.trim().replace(/\s+/g,"").split("").reverse().join(""),e=t.match(/[0-1]{8}/);return!0===n&&(e=t.match(/[0-1]{16}/)),null===e?null:parseInt(e[0].split("").reverse().join(""),2)}window.k=[];var e=document.getElementById("zip-file");document.getElementById("file-btn").onclick=function(){e.value=null},e.onchange=function(){if("application/x-zip-compressed"!=e.files[0].type)return console.error("Not a valid zip file");var d=document.getElementById("status-cover"),f=document.getElementById("status-text"),m=document.getElementById("status-text-ps");d.parentNode.classList.remove("hide"),d.parentNode.classList.add("show"),d.classList.add("spin"),d.innerText="讀取中",f.innerText="讀取壓縮檔中...",setTimeout(function(){d.innerText="解析中",f.innerText="解析檔案中...";var u=new FileReader;u.onload=function(){for(var e=new JSZip(u.result),n=Object.keys(e.files),a=[],t=0;t<n.length;t++){var r=n[t],i=r.split("/")[0].split("_").slice(-1)[0],o=r.split("/")[0].split("_")[0],l=r.split("/")[1].split(".").slice(-1)[0],r=e.files[r].asArrayBuffer();a.push({no:o,name:i,ext:l,bin:r})}var s=[["姓名","姓 Unicode","姓 UTF-16LE","姓 UTF-16BE","姓 UTF-8","名 Unicode","名 UTF-16LE","名 UTF-16BE","名 UTF-8","名 Unicode","名 UTF-16LE","名 UTF-16BE","名 UTF-8","備註"]],c=!1;(function e(t){var n=a[t];t==a.length-1&&(c=!0);d.innerText=n.name,f.innerHTML='正在批改<span style="color: blue">'+n.name+"</span>同學 ("+(100*(t+1)/a.length).toFixed(2)+"%)",m.innerText="正在比對資訊...";var r=[n.name];if("docx"!=n.ext)m.innerText="格式錯誤，並非 .docx 格式...",(r=new Array(12).fill("---")).push("格式錯誤，並非 docx 格式");else{for(var i=function(e){for(var e=new JSZip(e),e=new docxtemplater(e,{linebreaks:!0}).createTemplateClass("word/document.xml"),e=(new DOMParser).parseFromString(e.content,"application/xml").getElementsByTagName("w:body")[0].getElementsByTagName("w:tbl")[0],n=Array.from(e.getElementsByTagName("w:tr")).slice(2),t={},r=0;r<3;r++){var i=Array.from(n[r].childNodes);t[i[0].textContent.trim()]={unicode:v(i[1],!0),utf16LE:[v(i[2]),v(i[3])],utf16BE:[v(i[6]),v(i[7])],utf8:[v(i[10]),v(i[11]),v(i[12])]}}var o={};for(r in t){var a=r.codePointAt(0),l=[null,null].map(function(e,n){return new DataView(new Uint16Array([r.charCodeAt(0)]).buffer).getUint8(n,!1)}),s=l.slice().reverse(),c=encodeURIComponent(r).substring(1).split("%").map(function(e){return parseInt("0x"+e)});o[r]=[p(t[r].unicode,a),p(t[r].utf16LE.join(""),l.join("")),p(t[r].utf16BE.join(""),s.join("")),p(t[r].utf8.join(""),c.join(""))]}return o}(n.bin),o=0;o<n.name.length;o++)r=void 0!==i[n.name[o]]?r.concat(i[n.name[o]]):r.concat(new Array(4).fill("---"));r.push("")}s.push(r),setTimeout(function(){var n;c?(d.innerText="完成",m.innerText="",d.classList.remove("spin"),m.innerHTML='<a href="javascript:void(0);"> 點擊下載批改的 CSV 結果 </a>',n="",s.forEach(function(e){n+=e.join(",")+"\n"}),m.querySelector("a").onclick=function(){var e=document.createElement("a");e.href=URL.createObjectURL(new Blob([n],{type:"text/plain"})),e.download="批改結果.csv",e.click(),setTimeout(function(){URL.revokeObjectURL(e.href)},50)}):e(t+1)},50)})(0)},u.readAsArrayBuffer(e.files[0])},2e3)}}); </script></body></html>